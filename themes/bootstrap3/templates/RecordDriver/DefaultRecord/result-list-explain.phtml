<?php
  $link = $this->recordLinker()->getActionUrl($this->driver, 'Explain', $this->request);
?>
<a target="explain" href="<?=$this->escapeHtmlAttr($link)?>"><?=$this->transEsc('Explain')?></a>
<br>
<?php
  $recordId = $this->driver->getUniqueID();
  $score = $this->results->getScores()[$recordId] ?? false;
  $maxScore = $this->results->getMaxScore();
?>
<?php if ($score && $maxScore !== null && $maxScore > 0):?>
  <?php
    $this->headScript()->appendFile('vendor/chart.js');
    $this->headScript()->appendFile('explain.js');
  ?>
  <div class="result-list-explain">
    <canvas class="bar-chart"
            data-chart-title="<?=$this->transEsc('explain_compared', ['%%recordId%%' => $recordId])?>"
            data-chart-data="<?=$this->escapeHtmlAttr('[["item"],["value"]]')?>"
            data-max-score="<?=$maxScore?>"
            data-score="<?=$score?>"
    ></canvas>
  </div>
<?php endif; ?>
